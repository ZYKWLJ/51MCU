C51 COMPILER V9.60.7.0   MAIN                                                              04/22/2025 19:33:13 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\3software\keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(D:\3software\keil\C51\INC\
                    -Atmel) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          
   2          #include "lcd1602.h"
   3          #include "matrix.h"
   4          #include <string.h>
   5          
   6          // ÇåÁãº¯Êý
   7          void clear_password(unsigned char *start, unsigned char *my_code)
   8          {
   9   1          unsigned char i = 0; // ½«iµÄ¶¨ÒåÒÆµ½º¯Êý¿ªÍ·
  10   1          lcd1602_show_string(6, 1, "------");
  11   1          *start = 6;
  12   1          for (i = 0; i < 6; i++)
  13   1          {
  14   2              my_code[i] = 0;
  15   2          }
  16   1      }
  17          
  18          void main()
  19          {
  20   1          // ½«ËùÓÐ±äÁ¿¶¨ÒåÒÆµ½º¯Êý¿ªÍ·
  21   1          unsigned char key = 0;
  22   1          unsigned char start = 6; // ³ýÈ¥Ö®Ç°µÄINPUT:
  23   1          unsigned char password[7] = "123456";
  24   1          unsigned char my_code[7] = {0};
  25   1          unsigned char error_count=0;
  26   1          const unsigned char error_max_times=3;
  27   1          const unsigned char wait_times=3;
  28   1          unsigned char total_error=1;
  29   1          lcd1602_init();
  30   1          lcd1602_show_string(0, 0, "Password:");
  31   1          lcd1602_show_string(0, 1, "Input:");
  32   1          lcd1602_show_string(6, 1, "------");
  33   1      
  34   1          while (1)
  35   1          {
  36   2              key = matrixKey();
  37   2              if (key) // 0~9ÃÜÂë£¬10ÎªÈ·ÈÏ£¬11Î»ÎªÉ¾³ý£¬ÆäÓà²»Æð×÷ÓÃ
  38   2              {
  39   3                  if (key == 10) // È·ÈÏ¼ü£¬¿ÉÒÔÎ´µ½´ï12×Ô¼ºÈ·ÈÏ£¬µ«Ò»¶¨»á±¨´í
  40   3                  {
  41   4                      my_code[6] = '\0'; // È·±£×Ö·û´®ÕýÈ·ÖÕÖ¹£¬ÊÂÊµÉÏ£¬ÕâÀïÒ»¶¨ÊÇerrorµÄ£¬ÒòÎªÒ»µ©µ½´ï6´Î£¬¾ÍÖ±
             -½ÓÅÐ¶ÏÁË£¬²»»áÓÐ»ú»áÀ´ÕâÀï
  42   4                      if (strcmp((char *)my_code, (char *)password) == 0)
  43   4                      {
  44   5                          lcd1602_show_string(11, 0, "   "); // Çå¿ÕÔ­À´µÄERR
  45   5                          lcd1602_show_string(14, 0, "OK");
  46   5                          clear_password(&start, my_code); // ³É¹¦ÁËÊ§°Ü¼ÆÊ±ÇåÁã£¬ÊäÈëÇøÒ²ÇåÁã
  47   5                          error_count=0;
  48   5                      }
  49   4                      else
  50   4                      {
  51   5                          char error_str[6];
  52   5                          error_str[0] ='E';  
  53   5                          error_str[1] ='R';  
C51 COMPILER V9.60.7.0   MAIN                                                              04/22/2025 19:33:13 PAGE 2   

  54   5                          error_str[2] ='R';  
  55   5                          error_str[3] =' ';
  56   5                          error_str[4] =error_count+'0';  
  57   5                          error_str[5] ='\0';  
  58   5      
  59   5                          lcd1602_show_string(11, 0, error_str); // ´íÎóÖ®ºó£¬ÇåÁãÖØÐÂÊäÈë
  60   5                          error_count++;
  61   5                          clear_password(&start, my_code);
  62   5                      }
  63   4                  }
  64   3                  else if (key == 11) // È¡Ïû¼ü
  65   3                  {
  66   4                      if (start > 6)
  67   4                      {
  68   5                          lcd1602_show_string(--start, 1, "-");
  69   5                          my_code[start - 6] = 0;
  70   5                      }
  71   4                  }
  72   3                  else if (key > 11)
  73   3                  { // °´ÏÂ12ÒÔºóµÄ¼ü£¬Ã»ÓÐÈÎºÎÆäËû¹¦ÄÜ
  74   4                      continue;
  75   4                  }
  76   3                  else if (start < 12) // ·ÀÖ¹Êý×éÔ½½ç
  77   3                  {
  78   4                      unsigned char key_str[2];
  79   4                      key_str[0] = key + '0'; // ½«Êý×Ö×ª»»Îª×Ö·û
  80   4                      key_str[1] = '\0';      // Ìí¼Ó×Ö·û´®½áÊø·û
  81   4                      lcd1602_show_string(start++, 1,key_str ); // Ã¿°´ÏÂÒ»´Î£¬ÏÔÊ¾¹â±ê¾Í×óÒÆÒ»´Î
  82   4                      my_code[start - 7] = key + '0';                              // ×¢ÒâÕâÀïÓ¦¸ÃÊÇstart-7£¬ÒòÎ
             -ªstartÒÑ¾­×ÔÔöÁË
  83   4                  }
  84   3                  if (start == 12)
  85   3                  { // µ½´ï12Î»×Ô¶¯È·ÈÏ,×¢ÒâÕâÀïÊÇµ¥¶ÀµÄifÅÐ¶Ï£¬²»ÊÇelse if
  86   4      
  87   4                      my_code[6] = '\0'; // Ìí¼Ó×Ö·û´®½áÊø·û
  88   4                      if (strcmp((char *)my_code, (char *)password) == 0)
  89   4                      {
  90   5                          lcd1602_show_string(11, 0, "     "); // Çå¿ÕÔ­À´µÄERR
  91   5                          lcd1602_show_string(14, 0, "OK");//OKÏÔÊ¾ÁË1sºó×Ô¶¯ÏûÊ§
  92   5                          // ÏÔÊ¾welcome
  93   5                          lcd1602_show_string(0, 1, "----welcome-----");
  94   5                          delay1000ms();
  95   5                          delay1000ms();
  96   5                          delay1000ms();
  97   5                          //ÑÓ³Ù3sºóÓÖ¿ªÊ¼ÖØÐÂÊäÈë
  98   5                          lcd1602_show_string(0, 1, "                ");
  99   5                          lcd1602_show_string(0, 1, "Input:");
 100   5                          lcd1602_show_string(6, 1, "------");
 101   5                          clear_password(&start, my_code); // ³É¹¦ÁËÒ²ÒªÇåÁã£¡
 102   5                          error_count=0;
 103   5                      }
 104   4                      else
 105   4                      {
 106   5                          char error_str[6];
 107   5                          error_str[0] ='E';  
 108   5                          error_str[1] ='R';  
 109   5                          error_str[2] ='R';  
 110   5                          error_str[3] =' ';
 111   5                          error_str[4] =++error_count+'0';  //ÏÔÊ¾Ê§°Ü´ÎÊý
 112   5                          error_str[5] ='\0';  
 113   5                          lcd1602_show_string(11, 0, error_str); // ´íÎóÖ®ºó£¬ÇåÁãÖØÐÂÊäÈë // ERR±ÈOK³¤£¬»á×Ô¼º¸
             -²¸Ç
C51 COMPILER V9.60.7.0   MAIN                                                              04/22/2025 19:33:13 PAGE 3   

 114   5                          clear_password(&start, my_code);
 115   5                      }
 116   4                  }
 117   3                  if (error_count==error_max_times)
 118   3                  { 
 119   4                      // C89ÒªÇóËùÓÐÉùÃ÷ÒªÔÚº¯Êý¿ªÍ·£¬ËùÒÔÕâÀïÒª°Ñ±äÁ¿¶¨ÒåÒÆµ½º¯Êý¿ªÍ·
 120   4                      int i=wait_times*total_error;//Ã¿´íÒ»´Î£¬¾ÍÔö¼Ó1±¶ÑÓÊ±£¡
 121   4                      i=i>99?99:i;//²»³¬¹ý99sµÄµÈ´ýÊ±¼ä
 122   4                      total_error++;
 123   4                      lcd1602_show_string(0, 1, "-----Locked-----");
 124   4                      lcd1602_show_string(11, 0, "   ");//ÏÈ½«Ö®Ç°µÄOK»òERRÇå¿Õ
 125   4                      while(i>0){
 126   5                          //ÓÒÉÏ·½ÏÔÊ¾ÑÓÊ±ÐÅÏ¢£¬µ¹¼ÆÊ±£¡
 127   5                          if(i<10){
 128   6                              char wait_str[3];
 129   6                              wait_str[0]=i+'0';
 130   6                              wait_str[1]='s';
 131   6                              wait_str[2]='\0';
 132   6                              lcd1602_show_string(14, 0,wait_str);
 133   6                          }else{
 134   6                              //ÏÔÊ¾Á½Î»Êý
 135   6                              char wait_str[4];
 136   6                              wait_str[0]=i/10+'0';
 137   6                              wait_str[1]=i%10+'0';
 138   6                              wait_str[2]='s';
 139   6                              wait_str[3]='\0';
 140   6                              lcd1602_show_string(13, 0,wait_str);
 141   6                          }
 142   5                          delay1000ms();//ÑÓÊ±Ê±£¬Õâ¸öÊ±ºòÊäÈëÇøÏÔÊ¾Locked
 143   5                          i--;
 144   5                      }
 145   4                      lcd1602_show_string(13, 0, "   ");//½«Ö®Ç°µÄ¼ÆÊ±ÐÅÏ¢Çå¿Õ
 146   4                      lcd1602_show_string(0, 1, "                ");//Çå¿ÕÉÏÒ»ÐÐµÄËø×¡ÐÅÏ¢
 147   4                      error_count=0;//ÖØÖÃ´íÎó´ÎÊý
 148   4                      lcd1602_show_string(0, 1, "Input:");
 149   4                      lcd1602_show_string(6, 1, "------");//Ëø×¡µÄÊ±¼ä¹ýºó£¬ÓÖ¿ÉÒÔ¿ªÊ¼ÊäÈë
 150   4                  }
 151   3              }
 152   2          }
 153   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    752    ----
   CONSTANT SIZE    =    104    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      32
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
