C51 COMPILER V9.60.7.0   MAIN                                                              04/24/2025 01:59:43 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\3software\keil\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE INCDIR(D:\3software\keil\C51\INC\
                    -Atmel) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.h>
   2          #include "lcd1602.h"
   3          //´Ó00:00:00->23:59:59¼ÆÊ±Æ÷
   4          unsigned char hours=0;//Ê±ÖÓ
   5          unsigned char minutes=0;//·ÖÖÓ
   6          unsigned char seconds=0;//ÃëÖÓ
   7          unsigned char test=0;
   8          
   9          void num2str(unsigned char *ptr, unsigned char num) {
  10   1          *(ptr) = (num/10) + '0';    // Ê®Î»
  11   1          *(ptr+1) = (num%10) + '0';  // ¸öÎ»
  12   1      }
  13          
  14          static unsigned char now[9];
  15          unsigned char* time(unsigned char hours,unsigned char minutes,unsigned char seconds){
  16   1              //00:00:00¹²8Î» 
  17   1              now[2]=now[5]=':';
  18   1              num2str(now+0,hours);
  19   1              num2str(now+3,minutes);
  20   1              num2str(now+6,seconds);
  21   1              now[8] = '\0';  // Ìí¼Ó×Ö·û´®½áÊø·û
  22   1              return now;
  23   1      }
  24          
  25          
  26          
  27          void Timer0_Init(void) // 1ºÁÃë@12.000MHz
  28          {
  29   1          // AUXR &= 0x7F;                    //¶¨Ê±Æ÷Ê±ÖÓ12TÄ£Ê½
  30   1          TMOD &= 0xF0; // ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
  31   1          TMOD |= 0x01; // ÉèÖÃ¶¨Ê±Æ÷Ä£Ê½
  32   1          TL0 = 0x18;   // ÉèÖÃ¶¨Ê±³õÊ¼Öµ
  33   1          TH0 = 0xFC;   // ÉèÖÃ¶¨Ê±³õÊ¼Öµ
  34   1          TF0 = 0;      // Çå³ýTF0±êÖ¾
  35   1          TR0 = 1;      // ¶¨Ê±Æ÷0¿ªÊ¼¼ÆÊ±
  36   1          ET0 = 1;      // Ê¹ÄÜ¶¨Ê±Æ÷0ÖÐ¶Ï
  37   1          EA = 1;       // Ê¹ÄÜ×ÜÖÐ¶Ï
  38   1      }
  39          
  40          void main()
  41          {
  42   1              unsigned char prevSeconds = seconds; // ¼ÇÂ¼ÉÏÒ»´ÎµÄÃëÊý
  43   1          Timer0_Init();
  44   1          lcd1602_init();
  45   1          lcd1602_show_string(0, 0, time(hours, minutes, seconds)); // ³õÊ¼ÏÔÊ¾
  46   1          while (1) {
  47   2                      char str[2];
  48   2                      str[0]=test%10+'0';
  49   2                      str[1]='\0';
  50   2                      lcd1602_show_string(0, 1,str);
  51   2              if (seconds != prevSeconds) { // Ö»ÓÐÃëÊý±ä»¯Ê±²Å¸üÐÂÏÔÊ¾£¬·ÀÖ¹CPUÏûºÄ¹ýÖØ
  52   3                  lcd1602_show_string(8, 1, time(hours, minutes, seconds));
  53   3                  prevSeconds = seconds;
  54   3              }
C51 COMPILER V9.60.7.0   MAIN                                                              04/24/2025 01:59:43 PAGE 2   

  55   2          }
  56   1      }
  57          static unsigned int count=0;
  58          
  59          void Timer0_ISR(void) interrupt 1
  60          {
  61   1              //ÎªÊ²Ã´²»ÔÚÕâÀïÉùÃ÷countÊ¹ÓÃ¾Í»áµ¼ÖÂÓÀÔ¶¸üÐÂ²»ÁË£¿°üÀ¨ÔÚÍâÃæÒ²²»ÐÐ£¿ÕâÊÇÒ»¸ö¿Ó£¡
  62   1              //µ±³ÌÐòÖ´ÐÐµ½ static unsigned int count; ÕâÒ»ÐÐ´úÂëÊ±£¨È·ÇÐµØËµÊÇµÚÒ»´Î½øÈë°üº¬¸ÃÉùÃ÷µÄº¯ÊýÊ±£©£¬count ±
             -äÁ¿»á±»×Ô¶¯³õÊ¼»¯Îª 0 ¡£
  63   1              //ÖÐ¶Ïº¯Êý×¼Ôò£¬²»ÒªÔÚÀïÃæÌí¼Ó¹ý³¤ÈÎÎñ£¡
  64   1              //ÖØÖÃ¼ÆÊýÆ÷TH¡¢TL
  65   1              TL0 = 0x18;   // ÉèÖÃ¶¨Ê±³õÊ¼Öµ
  66   1          TH0 = 0xFC;   // ÉèÖÃ¶¨Ê±³õÊ¼Öµ
  67   1              count++;
  68   1              
  69   1              if(count == 1000) {
  70   2              P2_0 = ~P2_0;  // µ÷ÊÔÐÅºÅ£¬ÕâÀï¾ÍÃ»½øÀ´£¬ËµÃ÷¸ù±¾¾ÍÃ»´¥·¢ÖÐ¶Ï£¡Õ¦¸ãµÄ£¡
  71   2              count = 0;
  72   2              seconds++;
  73   2              test++;
  74   2              // ÐÞÕýÊ±¼ä¼ÆËãÂß¼­
  75   2              if(seconds >= 60) {
  76   3                  seconds = 0;
  77   3                  minutes++;
  78   3                  if(minutes >= 60) {
  79   4                      minutes = 0;
  80   4                      hours++;
  81   4                      if(hours >= 24) {
  82   5                          hours = 0;
  83   5                      }
  84   4                  }
  85   3              }
  86   2              
  87   2          }
  88   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    239    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     15       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
